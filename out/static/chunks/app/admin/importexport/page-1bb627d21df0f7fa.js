(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7021],{86162:function(e,r,t){Promise.resolve().then(t.bind(t,50545))},50545:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return h}});var n=t(57437),a=t(2265),s=t(62869),l=t(15452),i=t.n(l),o=t(66070),d=t(48736),c=t(17689);let u=(0,t(79205).Z)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var m=t(35974);function f(e,r){fetch(e).then(e=>e.blob()).then(e=>{let t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=r,document.body.appendChild(t),t.click(),document.body.removeChild(t)})}function p(){let[e,r]=(0,a.useState)(null),[t,l]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),[x,g]=(0,a.useState)(!1),[v,b]=(0,a.useState)(null),[y,j]=(0,a.useState)(null),N=(0,a.useRef)(null);async function w(e){var t;h(null),b(null);let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(j(n||null),n)try{let e=await fetch("/api/admin/products"),t=await e.json();i().parse(n,{header:!0,skipEmptyLines:!0,complete:e=>{if(e.errors.length)h("CSV parse error: "+e.errors[0].message),r(null),l(null);else{let n=e.data;r(n.slice(0,5)),l(function(e,r){let t=new Set(r.map(e=>e.id)),n=new Set(r.map(e=>e.slug)),a=0,s=0,l=0;for(let r of e){if(!r.name||!r.slug){l++;continue}r.id&&t.has(r.id)?s++:n.has(r.slug)?s++:a++}return{creates:a,updates:s,errors:l}}(n,t))}},error:e=>h("CSV parse error: "+e.message)})}catch(e){h("Failed to fetch existing products: "+(e.message||e))}}async function k(){if(!y)return;g(!0),h(null),b(null);let e=new FormData;e.append("file",y);try{let t=await fetch("/api/admin/import/products",{method:"POST",body:e}),n=await t.json();b(n),t.ok||h(n.error||"Import failed"),r(null),l(null),j(null)}catch(e){h(e.message||"Import failed")}finally{g(!1)}}return(0,n.jsxs)("div",{className:"w-full min-h-[80vh] flex flex-col bg-background px-12 py-12",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-2 text-primary",children:"Import & Export Data"}),(0,n.jsx)("p",{className:"text-muted-foreground max-w-2xl",children:"Easily import new products or update existing ones using a CSV file, and export your store data for backup, reporting, or migration. Use the template for correct import formatting."})]}),(0,n.jsxs)("div",{className:"w-full grid grid-cols-1 md:grid-cols-2 gap-12 items-stretch",children:[(0,n.jsxs)(o.Zb,{className:"flex flex-col w-full h-full min-h-[400px] shadow-lg border border-gray-200 bg-white p-8",children:[(0,n.jsxs)(o.Ol,{className:"flex flex-row items-center gap-3 pb-2",children:[(0,n.jsx)(d.Z,{className:"text-primary w-6 h-6"}),(0,n.jsx)(o.ll,{className:"text-xl font-bold",children:"Export Data"})]}),(0,n.jsxs)(o.aY,{className:"flex flex-col gap-4 flex-1",children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,n.jsx)(s.z,{variant:"outline",size:"sm",className:"hover:bg-primary/10",onClick:()=>f("/api/admin/export/orders","orders.csv"),children:"Export Orders"}),(0,n.jsx)(s.z,{variant:"outline",size:"sm",className:"hover:bg-primary/10",onClick:()=>f("/api/admin/export/products","products.csv"),children:"Export Products"}),(0,n.jsx)(s.z,{variant:"outline",size:"sm",className:"hover:bg-primary/10",onClick:()=>f("/api/admin/export/customers","customers.csv"),children:"Export Customers"}),(0,n.jsx)(s.z,{variant:"outline",size:"sm",className:"hover:bg-primary/10",onClick:()=>f("/api/admin/export/analytics","analytics.csv"),children:"Export Analytics"})]}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground mt-2",children:"Download CSV files for backup, reporting, or migration."})]})]}),(0,n.jsxs)(o.Zb,{className:"flex flex-col w-full h-full min-h-[400px] shadow-lg border border-gray-200 bg-white p-8",children:[(0,n.jsxs)(o.Ol,{className:"flex flex-row items-center gap-3 pb-2",children:[(0,n.jsx)(c.Z,{className:"text-primary w-6 h-6"}),(0,n.jsx)(o.ll,{className:"text-xl font-bold",children:"Import Products"})]}),(0,n.jsxs)(o.aY,{className:"flex flex-col gap-4 flex-1",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,n.jsx)("input",{ref:N,type:"file",accept:".csv",className:"hidden",onChange:w}),(0,n.jsxs)(s.z,{variant:"default",size:"sm",onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},disabled:x,children:[(0,n.jsx)(c.Z,{className:"w-4 h-4 mr-2"})," Choose CSV File"]}),(0,n.jsx)(s.z,{variant:"link",size:"sm",className:"px-0",onClick:function(){let e=["id","name","slug","price","stockQuantity","isActive"],r=new Blob([[e.join(","),...[{id:"",name:"Aloe Vera",slug:"aloe-vera",price:"99.99",stockQuantity:"10",isActive:"true"},{id:"",name:"Snake Plant",slug:"snake-plant",price:"149.99",stockQuantity:"5",isActive:"true"}].map(r=>e.map(e=>r[e]).join(","))].join("\n")],{type:"text/csv"}),t=document.createElement("a");t.href=URL.createObjectURL(r),t.download="products-template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t)},children:"Download Template"})]}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"Import a CSV file to add or update products. Download the template for the correct format."})]}),Array.isArray(e)&&e.length>0&&(0,n.jsxs)("div",{className:"mt-4 bg-muted p-4 rounded border",children:[(0,n.jsxs)("div",{className:"font-semibold mb-2 flex items-center gap-2",children:[(0,n.jsx)(u,{className:"w-4 h-4 text-primary"})," Import Preview (first 5 rows):"]}),(0,n.jsx)("div",{className:"overflow-x-auto rounded-lg border",children:(0,n.jsxs)("table",{className:"text-xs w-full border-collapse",children:[(0,n.jsx)("thead",{className:"bg-gray-100 sticky top-0 z-10",children:(0,n.jsx)("tr",{children:Object.keys(e[0]||{}).map(e=>(0,n.jsx)("th",{className:"border px-2 py-1 font-semibold text-left text-muted-foreground",children:e},e))})}),(0,n.jsx)("tbody",{children:e.map((e,r)=>(0,n.jsx)("tr",{className:"even:bg-gray-50",children:Object.values(e).map((e,r)=>(0,n.jsx)("td",{className:"border px-2 py-1",children:String(e)},r))},r))})]})}),t&&(0,n.jsxs)("div",{className:"mt-2 flex gap-4",children:[(0,n.jsxs)(m.C,{variant:"default",children:["Creates: ",t.creates]}),(0,n.jsxs)(m.C,{variant:"secondary",children:["Updates: ",t.updates]}),(0,n.jsxs)(m.C,{variant:"destructive",children:["Errors: ",t.errors]})]}),(0,n.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,n.jsx)(s.z,{size:"sm",variant:"default",className:"hover:bg-primary/90",onClick:k,disabled:x,children:"Confirm Import"}),(0,n.jsx)(s.z,{size:"sm",variant:"outline",className:"hover:bg-primary/10",onClick:()=>{r(null),l(null)},children:"Cancel"})]})]}),p&&(0,n.jsx)("div",{className:"text-destructive mt-2",children:p}),v&&(0,n.jsxs)("div",{className:"mt-4 bg-muted p-4 rounded border",children:[(0,n.jsx)("div",{className:"font-semibold mb-2",children:"Import Result:"}),(0,n.jsxs)("div",{children:["Created: ",(0,n.jsx)("b",{children:v.created})]}),(0,n.jsxs)("div",{children:["Updated: ",(0,n.jsx)("b",{children:v.updated})]}),(0,n.jsxs)("div",{children:["Failed: ",(0,n.jsx)("b",{children:v.failed})]}),Array.isArray(v.errors)&&v.errors.length>0&&(0,n.jsxs)("div",{className:"mt-2 text-destructive",children:[(0,n.jsx)("div",{children:"Errors:"}),(0,n.jsx)("ul",{className:"list-disc ml-6",children:v.errors.map((e,r)=>(0,n.jsx)("li",{children:e},r))})]}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)(s.z,{size:"sm",variant:"outline",className:"hover:bg-primary/10",onClick:()=>b(null),children:"Close"})})]})]})]})]})]})}function h(){return(0,n.jsx)(p,{})}},35974:function(e,r,t){"use strict";t.d(r,{C:function(){return i}});var n=t(57437);t(2265);var a=t(77712),s=t(94508);let l=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(l({variant:t}),r),...a})}},62869:function(e,r,t){"use strict";t.d(r,{d:function(){return o},z:function(){return d}});var n=t(57437),a=t(2265),s=t(37053),l=t(77712),i=t(94508);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,r)=>{let{className:t,variant:a,size:l,asChild:d=!1,...c}=e,u=d?s.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(o({variant:a,size:l,className:t})),ref:r,...c})});d.displayName="Button"},66070:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return c},ll:function(){return o}});var n=t(57437),a=t(2265),s=t(94508);let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});l.displayName="Card";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},32507:function(e,r,t){"use strict";t.d(r,{_:function(){return l}});var n,a=t(93340),s=t(40257);let l=null!==(n=globalThis.prisma)&&void 0!==n?n:new a.PrismaClient({log:["error"],datasources:{db:{url:s.env.DATABASE_URL}}});s.on("beforeExit",async()=>{await l.$disconnect()})},94508:function(e,r,t){"use strict";t.d(r,{Bp:function(){return l},cn:function(){return s}});var n=t(61994),a=t(53335);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,n.W)(r))}function l(e,r){if(e===r)return 0;if(!e.length)return r.length;if(!r.length)return e.length;let t=Array.from({length:e.length+1},()=>Array(r.length+1).fill(0));for(let r=0;r<=e.length;r++)t[r][0]=r;for(let e=0;e<=r.length;e++)t[0][e]=e;for(let n=1;n<=e.length;n++)for(let a=1;a<=r.length;a++){let s=e[n-1]===r[a-1]?0:1;t[n][a]=Math.min(t[n-1][a]+1,t[n][a-1]+1,t[n-1][a-1]+s)}return t[e.length][r.length]}t(32507)},79205:function(e,r,t){"use strict";t.d(r,{Z:function(){return o}});var n=t(2265);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&t.indexOf(e)===r).join(" ")};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,r)=>{let{color:t="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:u,...m}=e;return(0,n.createElement)("svg",{ref:r,...l,width:a,height:a,stroke:t,strokeWidth:o?24*Number(i)/Number(a):i,className:s("lucide",d),...m},[...u.map(e=>{let[r,t]=e;return(0,n.createElement)(r,t)}),...Array.isArray(c)?c:[c]])}),o=(e,r)=>{let t=(0,n.forwardRef)((t,l)=>{let{className:o,...d}=t;return(0,n.createElement)(i,{ref:l,iconNode:r,className:s("lucide-".concat(a(e)),o),...d})});return t.displayName="".concat(e),t}},48736:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(79205).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},17689:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(79205).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}},function(e){e.O(0,[2981,5907,2971,2117,1744],function(){return e(e.s=86162)}),_N_E=e.O()}]);