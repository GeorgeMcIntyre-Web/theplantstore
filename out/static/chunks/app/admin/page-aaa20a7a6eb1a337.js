(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{15445:function(e,t,s){Promise.resolve().then(s.bind(s,67436))},67436:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return em}});var a=s(57437),r=s(2265),n=s(27107),i=s(31047),l=s(94508),o=s(62869),d=s(92451),c=s(10407),u=s(55965);function m(e){let{className:t,classNames:s,showOutsideDays:r=!0,...n}=e;return(0,a.jsx)(u._W,{showOutsideDays:r,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,o.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,o.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>{let{...t}=e;return(0,a.jsx)(d.Z,{className:"h-4 w-4"})},IconRight:e=>{let{...t}=e;return(0,a.jsx)(c.Z,{className:"h-4 w-4"})}},...n})}m.displayName="Calendar";var h=s(27312);let p=h.fC,f=h.xz,x=r.forwardRef((e,t)=>{let{className:s,align:r="center",sideOffset:n=4,...i}=e;return(0,a.jsx)(h.h_,{children:(0,a.jsx)(h.VY,{ref:t,align:r,sideOffset:n,className:(0,l.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});function g(e){let{value:t,onChange:s,className:r}=e;return(0,a.jsx)("div",{className:(0,l.cn)("grid gap-2",r),children:(0,a.jsxs)(p,{children:[(0,a.jsx)(f,{asChild:!0,children:(0,a.jsxs)(o.z,{id:"date",variant:"outline",className:(0,l.cn)("w-[300px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[(0,a.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),(null==t?void 0:t.from)?t.to?(0,a.jsxs)(a.Fragment,{children:[(0,n.WU)(t.from,"LLL dd, y")," -"," ",(0,n.WU)(t.to,"LLL dd, y")]}):(0,n.WU)(t.from,"LLL dd, y"):(0,a.jsx)("span",{children:"Pick a date range"})]})}),(0,a.jsx)(x,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(m,{initialFocus:!0,mode:"range",defaultMonth:null==t?void 0:t.from,selected:t,onSelect:e=>s(e),numberOfMonths:2})})]})})}x.displayName=h.VY.displayName;var v=s(5341),j=s(63070),b=s(27742),y=s(35902);let N=[{label:"Last 7 days",getRange:()=>{let e=new Date;return{from:(0,v.k)(e,6),to:e}}},{label:"Last 30 days",getRange:()=>{let e=new Date;return{from:(0,v.k)(e,29),to:e}}},{label:"This Month",getRange:()=>{let e=new Date;return{from:(0,j.N)(e),to:(0,b.V)(e)}}},{label:"Last Month",getRange:()=>{let e=new Date,t=(0,y.W)(e,1);return{from:(0,j.N)(t),to:(0,b.V)(t)}}}];function w(e){let{dateRange:t,onDateRangeChange:s}=e,[i,l]=(0,r.useState)(null);return(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:N.map(e=>(0,a.jsx)(o.z,{variant:"secondary",size:"sm",onClick:()=>s(e.getRange()),children:e.label},e.label))}),(0,a.jsx)(g,{value:t,onChange:s}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:(null==t?void 0:t.from)&&(null==t?void 0:t.to)?"".concat((0,n.WU)(t.from,"LLL dd, y")," - ").concat((0,n.WU)(t.to,"LLL dd, y")):"No range selected"})]})})}var S=s(47625),k=s(21156),A=s(56940),C=s(97059),R=s(62994),T=s(8147),O=s(54061);function M(e){let{data:t}=e;return(0,a.jsx)(S.h,{width:"100%",height:250,children:(0,a.jsxs)(k.w,{data:t,margin:{top:10,right:20,left:0,bottom:0},children:[(0,a.jsx)(A.q,{strokeDasharray:"3 3"}),(0,a.jsx)(C.K,{dataKey:"date"}),(0,a.jsx)(R.B,{}),(0,a.jsx)(T.u,{}),(0,a.jsx)(O.x,{type:"monotone",dataKey:"sales",stroke:"#22c55e",name:"Sales"}),(0,a.jsx)(O.x,{type:"monotone",dataKey:"orders",stroke:"#3b82f6",name:"Orders"})]})})}function _(e){let{data:t}=e;return(0,a.jsx)(S.h,{width:"100%",height:250,children:(0,a.jsxs)(k.w,{data:t,margin:{top:10,right:20,left:0,bottom:0},children:[(0,a.jsx)(A.q,{strokeDasharray:"3 3"}),(0,a.jsx)(C.K,{dataKey:"date"}),(0,a.jsx)(R.B,{allowDecimals:!1}),(0,a.jsx)(T.u,{}),(0,a.jsx)(O.x,{type:"monotone",dataKey:"signups",stroke:"#3b82f6",name:"Signups"})]})})}var D=s(77031),z=s(31699);function P(e){let{data:t}=e;return(0,a.jsx)(S.h,{width:"100%",height:250,children:(0,a.jsxs)(D.v,{data:t,margin:{top:10,right:20,left:0,bottom:0},children:[(0,a.jsx)(A.q,{strokeDasharray:"3 3"}),(0,a.jsx)(C.K,{dataKey:"name"}),(0,a.jsx)(R.B,{allowDecimals:!1}),(0,a.jsx)(T.u,{}),(0,a.jsx)(z.$,{dataKey:"salesCount",fill:"#22c55e",name:"Units Sold"})]})})}var L=s(75169),E=s(3574),F=s(20407),I=s(22190);let U=["#22c55e","#3b82f6","#f59e42","#ef4444","#a855f7","#fbbf24","#10b981","#6366f1"];function Z(e){let{data:t}=e;return(0,a.jsx)(S.h,{width:"100%",height:250,children:(0,a.jsxs)(L.u,{children:[(0,a.jsx)(E.b,{data:t,dataKey:"revenue",nameKey:"category",cx:"50%",cy:"50%",outerRadius:80,fill:"#22c55e",label:!0,children:t.map((e,t)=>(0,a.jsx)(F.b,{fill:U[t%U.length]},"cell-".concat(t)))}),(0,a.jsx)(T.u,{formatter:e=>"R".concat(e.toFixed(2))}),(0,a.jsx)(I.D,{})]})})}var G=s(81596),V=s(42488),q=s(33276),W=s(80605),K=s(27648),B=s(35153),Y=s(93022),Q=s(66070),H=s(35974),J=s(60610);let $=r.forwardRef((e,t)=>{let{className:s,value:r,...n}=e;return(0,a.jsx)(J.fC,{ref:t,className:(0,l.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:(0,a.jsx)(J.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});$.displayName=J.fC.displayName;var X=s(58896),ee=s(32489),et=s(41671),es=s(89227),ea=s(51548);function er(e){let{steps:t,isOpen:s,onClose:n,onComplete:i,userRole:u,className:m}=e,[h,p]=(0,r.useState)(0),[f,x]=(0,r.useState)(!1),[g,v]=(0,r.useState)(new Set),j=(h+1)/t.length*100;(0,r.useEffect)(()=>{if(f){let e=setTimeout(()=>{h<t.length-1?p(e=>e+1):x(!1)},3e3);return()=>clearTimeout(e)}},[h,f,t.length]);let b=e=>{p(e)};if(!s)return null;let y=t[h];return(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:(0,a.jsxs)(Q.Zb,{className:(0,l.cn)("w-full max-w-2xl",m),children:[(0,a.jsxs)(Q.Ol,{className:"pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X.Z,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)(Q.ll,{className:"text-lg",children:"Welcome to The Plant Store Admin"}),u&&(0,a.jsx)(H.C,{variant:"secondary",className:"ml-2",children:u.replace("_"," ")})]}),(0,a.jsx)(o.z,{variant:"ghost",size:"sm",onClick:n,className:"h-8 w-8 p-0",children:(0,a.jsx)(ee.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-2",children:[(0,a.jsxs)("span",{children:["Step ",h+1," of ",t.length]}),(0,a.jsxs)("span",{children:[Math.round(j),"% Complete"]})]}),(0,a.jsx)($,{value:j,className:"h-2"})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 mt-3",children:t.map((e,t)=>(0,a.jsx)("button",{onClick:()=>b(t),className:(0,l.cn)("w-3 h-3 rounded-full transition-colors",t===h?"bg-blue-600":g.has(e.id)?"bg-green-500":"bg-gray-300 hover:bg-gray-400"),title:"Step ".concat(t+1,": ").concat(e.title)},e.id))})]}),(0,a.jsxs)(Q.aY,{className:"pt-0",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[y.title,g.has(y.id)&&(0,a.jsx)(et.Z,{className:"h-5 w-5 text-green-500"})]}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4 leading-relaxed",children:y.content}),y.tips&&y.tips.length>0&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCA1 Quick Tips:"}),(0,a.jsx)("ul",{className:"text-sm text-blue-800 space-y-1",children:y.tips.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-blue-600 mt-1",children:"â€¢"}),(0,a.jsx)("span",{children:e})]},t))})]}),y.action&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,a.jsx)("h4",{className:"font-medium text-green-900 mb-1",children:"\uD83C\uDFAF Action Required:"}),(0,a.jsx)("p",{className:"text-sm text-green-800",children:y.action})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>{h>0&&p(e=>e-1)},disabled:0===h,children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,a.jsx)(o.z,{variant:"outline",size:"sm",onClick:()=>x(!f),children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.Z,{className:"h-4 w-4 mr-1"}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q.Z,{className:"h-4 w-4 mr-1"}),"Auto-play"]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(o.z,{variant:"ghost",size:"sm",onClick:()=>{i()},children:[(0,a.jsx)(ea.Z,{className:"h-4 w-4 mr-1"}),"Skip Tour"]}),(0,a.jsx)(o.z,{onClick:()=>{h<t.length-1?(p(e=>e+1),v(e=>new Set(Array.from(e).concat([t[h].id])))):i()},className:"min-w-[100px]",children:h===t.length-1?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(et.Z,{className:"h-4 w-4 mr-1"}),"Complete"]}):(0,a.jsxs)(a.Fragment,{children:["Next",(0,a.jsx)(c.Z,{className:"h-4 w-4 ml-1"})]})})]})]})]})]})})}let en={SUPER_ADMIN:[{id:"dashboard-overview",title:"Dashboard Overview",content:"Welcome to your admin dashboard! This is your command center for managing The Plant Store. You'll see key metrics, recent activity, and quick access to all features.",tips:["Check the analytics charts for business insights","Use the date range picker to view different periods","Monitor system health and user activity"]},{id:"user-management",title:"User Management",content:"As a Super Admin, you can create and manage all user accounts. Set appropriate roles and permissions for each team member.",action:"Go to Users tab and review existing accounts",tips:["Create accounts for new team members","Set appropriate roles (Plant Manager, Order Manager, etc.)","Monitor user activity and access"]},{id:"system-settings",title:"System Configuration",content:"Configure global settings for your store including categories, suppliers, shipping rates, and system preferences.",action:"Visit Settings to configure your store",tips:["Set up product categories","Add supplier information","Configure shipping rates by province"]},{id:"financial-oversight",title:"Financial Oversight",content:"Monitor all financial activities including revenue, expenses, and financial reports. Ensure proper VAT compliance.",action:"Review the Accounting section",tips:["Monitor daily revenue and expenses","Review expense approvals","Generate financial reports"]}],PLANT_MANAGER:[{id:"product-catalog",title:"Product Catalog",content:"Manage your plant catalog efficiently. Add new products, update inventory, and ensure quality product information.",action:"Go to Products tab to view your catalog",tips:["Upload 4-6 high-quality product images","Write compelling descriptions with care instructions","Set accurate pricing and stock levels"]},{id:"inventory-control",title:"Inventory Management",content:"Monitor stock levels and manage inventory efficiently. Set up alerts for low stock items.",action:"Check Low Stock items in Products",tips:["Monitor stock levels daily","Set up automatic low stock alerts","Create purchase orders when needed"]},{id:"supplier-management",title:"Supplier Relations",content:"Manage supplier relationships and track performance. Monitor delivery times and maintain supplier information.",action:"Review Suppliers section",tips:["Maintain supplier contact information","Track supplier performance","Monitor delivery times"]}],ORDER_MANAGER:[{id:"order-processing",title:"Order Processing",content:"Process customer orders efficiently. Review order details, check inventory, and update order status.",action:"Go to Orders tab to view pending orders",tips:["Review order details and customer information","Check inventory availability before processing","Update order status promptly"]},{id:"customer-service",title:"Customer Service",content:"Provide excellent customer support. Handle inquiries, process returns, and maintain customer satisfaction.",action:"Review Customers section",tips:["Respond to inquiries within 2 hours","Handle order modifications and returns","Follow up on delivery issues"]},{id:"shipping-management",title:"Shipping Management",content:"Coordinate shipping and tracking. Generate shipping labels and update customers on delivery status.",action:"Check Shipping section",tips:["Generate shipping labels","Update tracking numbers","Monitor delivery status"]}],FINANCIAL_MANAGER:[{id:"financial-dashboard",title:"Financial Dashboard",content:"Monitor your store's financial health. Track revenue, expenses, and key financial metrics.",action:"Review the Accounting dashboard",tips:["Monitor daily revenue and expenses","Track profit margins and trends","Review VAT liability"]},{id:"expense-approval",title:"Expense Approval",content:"Review and approve expense requests. Ensure proper documentation and budget compliance.",action:"Check Pending Approvals",tips:["Review expense details and documentation","Check budget availability","Approve or reject with comments"]},{id:"financial-reporting",title:"Financial Reporting",content:"Generate and analyze financial reports. Track trends and ensure compliance.",action:"Generate a financial report",tips:["Create monthly financial statements","Analyze expense trends","Prepare VAT returns"]}]};var ei=s(75368),el=s(81103);function eo(e){let{content:t,title:s,position:n="top",className:i,variant:d="default",showIcon:c=!0,children:u}=e,[m,h]=r.useState(!1);return(0,a.jsx)(el.pn,{children:(0,a.jsxs)(el.u,{open:m,onOpenChange:h,children:[(0,a.jsx)(el.aJ,{asChild:!0,children:u||(0,a.jsx)(o.z,{variant:"ghost",size:"sm",className:(0,l.cn)("h-4 w-4 p-0",i),onClick:e=>{e.preventDefault(),h(!m)},children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(el._v,{side:n,className:(0,l.cn)("max-w-sm p-4 border shadow-lg",{default:"bg-popover text-popover-foreground",info:"bg-blue-50 text-blue-900 border-blue-200",warning:"bg-yellow-50 text-yellow-900 border-yellow-200",success:"bg-green-50 text-green-900 border-green-200"}[d]),children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[s&&(0,a.jsx)("div",{className:"font-semibold mb-2",children:s}),(0,a.jsx)("div",{className:"text-sm leading-relaxed",children:t})]}),(0,a.jsx)(o.z,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 ml-2",onClick:()=>h(!1),children:(0,a.jsx)(ee.Z,{className:"h-3 w-3"})})]})})]})})}let ed={products:{title:"Product Management",content:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-2",children:"Manage your product catalog efficiently:"}),(0,a.jsxs)("ul",{className:"text-xs space-y-1",children:[(0,a.jsx)("li",{children:"â€¢ Upload 4-6 high-quality images (800x800px minimum)"}),(0,a.jsx)("li",{children:"â€¢ Write compelling descriptions with care instructions"}),(0,a.jsx)("li",{children:"â€¢ Set accurate pricing and stock levels"}),(0,a.jsx)("li",{children:"â€¢ Monitor low stock alerts daily"})]})]})},orders:{title:"Order Processing",content:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-2",children:"Process orders efficiently:"}),(0,a.jsxs)("ul",{className:"text-xs space-y-1",children:[(0,a.jsx)("li",{children:"â€¢ Review order details and customer information"}),(0,a.jsx)("li",{children:"â€¢ Check inventory availability before processing"}),(0,a.jsx)("li",{children:"â€¢ Update order status promptly"}),(0,a.jsx)("li",{children:"â€¢ Send tracking information to customers"})]})]})},accounting:{title:"Financial Management",content:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-2",children:"Manage finances and expenses:"}),(0,a.jsxs)("ul",{className:"text-xs space-y-1",children:[(0,a.jsx)("li",{children:"â€¢ Review and approve expense requests"}),(0,a.jsx)("li",{children:"â€¢ Monitor budget vs actual spending"}),(0,a.jsx)("li",{children:"â€¢ Track VAT liability (15% rate)"}),(0,a.jsx)("li",{children:"â€¢ Generate financial reports regularly"})]})]})},customers:{title:"Customer Service",content:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-2",children:"Provide excellent customer support:"}),(0,a.jsxs)("ul",{className:"text-xs space-y-1",children:[(0,a.jsx)("li",{children:"â€¢ Respond to inquiries within 2 hours"}),(0,a.jsx)("li",{children:"â€¢ Handle order modifications and returns"}),(0,a.jsx)("li",{children:"â€¢ Maintain customer satisfaction"}),(0,a.jsx)("li",{children:"â€¢ Follow up on delivery issues"})]})]})}};function ec(e){let{title:t,icon:s,children:r}=e;return(0,a.jsxs)("div",{className:"bg-card rounded-lg p-6 shadow border",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[s,t]}),r]})}function eu(){return(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(Y.O,{className:"h-48 w-full mb-4"},t)),(0,a.jsx)(Y.O,{className:"h-32 w-full lg:col-span-2"}),(0,a.jsx)(Y.O,{className:"h-32 w-full mt-8"})]})}function em(){var e;let{data:t}=(0,W.useSession)(),s=null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.role,[n,i]=(0,r.useState)({from:(0,v.k)(new Date,29),to:new Date}),[l,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),[p,f]=(0,r.useState)([]),[x,g]=(0,r.useState)(!1),[j,b]=(0,r.useState)(0),[y,N]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(u(!0),h(null),!n.from||!n.to){d(null),u(!1);return}fetch("/api/admin/analytics?from=".concat(n.from.toISOString().slice(0,10),"&to=").concat(n.to.toISOString().slice(0,10))).then(e=>e.json()).then(e=>{e.error?h(e.error):d(e)}).catch(e=>h("Failed to fetch analytics")).finally(()=>u(!1)),fetch("/api/products").then(e=>e.json()).then(e=>{f((Array.isArray(e)?e:Array.isArray(e.products)?e.products:[]).filter(e=>"number"==typeof e.stockQuantity&&"number"==typeof e.effectiveLowStockThreshold&&e.stockQuantity<=e.effectiveLowStockThreshold))})},[n,j]);let A=async()=>{g(!0);try{var e;let s=await fetch("/api/admin/purchase-orders/auto-draft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminId:null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.id})}),a=await s.json();(0,B.Am)({title:a.created>0?"Created ".concat(a.created," draft POs"):"No new POs needed",description:a.created>0?"Review and approve in Purchase Orders.":void 0})}catch(e){(0,B.Am)({title:"Error",description:"Failed to suggest POs",variant:"destructive"})}finally{g(!1)}};return(0,a.jsxs)("div",{className:"w-full",children:[(null==t?void 0:t.user)&&(0,a.jsx)(eh,{name:t.user.name||"Admin",role:s,onStartTour:()=>N(!0),hasCompletedTour:S}),!c&&!m&&(!l||l&&Object.values(l).every(e=>Array.isArray(e)&&0===e.length))&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 text-blue-900 rounded-lg p-4 mb-6",children:[(0,a.jsx)("div",{className:"font-semibold mb-1",children:"Welcome to your Admin Dashboard!"}),(0,a.jsxs)("div",{className:"text-sm",children:["SUPER_ADMIN"===s&&(0,a.jsxs)(a.Fragment,{children:["As a ",(0,a.jsx)("b",{children:"Super Admin"}),", you have full access to manage products, orders, users, and all settings. Use the sidebar to explore features. Need help? See the admin guide or contact support."]}),"FINANCIAL_MANAGER"===s&&(0,a.jsxs)(a.Fragment,{children:["As a ",(0,a.jsx)("b",{children:"Financial Manager"}),", you can view analytics, manage expenses, and run reports. Use the sidebar to access accounting features. Need help? See the admin guide or contact support."]}),!s&&(0,a.jsx)(a.Fragment,{children:"Use the sidebar to explore admin features. Need help? See the admin guide or contact support."})]})]}),(0,a.jsx)(w,{dateRange:n,onDateRangeChange:i}),c&&(0,a.jsx)(eu,{}),m&&(0,a.jsxs)("div",{className:"p-4 text-center text-destructive",role:"alert","aria-live":"assertive",children:[m,(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(o.z,{variant:"outline",size:"sm",onClick:()=>b(e=>e+1),children:"Retry"})})]}),!c&&!m&&l&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsx)(ec,{title:"Sales & Orders",icon:(0,a.jsx)(G.Z,{className:"h-5 w-5"}),children:(0,a.jsx)(M,{data:l.salesData})}),(0,a.jsx)(ec,{title:"Customer Growth",children:(0,a.jsx)(_,{data:l.customerGrowthData})}),(0,a.jsx)(ec,{title:"Top Products",children:(0,a.jsx)(P,{data:l.topProductsData})}),(0,a.jsx)(ec,{title:"Revenue Breakdown",children:(0,a.jsx)(Z,{data:l.revenueByCategoryData})}),(0,a.jsx)(ec,{title:"Recent Activity",icon:(0,a.jsx)(V.Z,{className:"h-5 w-5"}),children:0===l.recentOrders.length?(0,a.jsx)("div",{className:"text-muted-foreground",children:"No recent orders."}):(0,a.jsx)("ul",{className:"divide-y divide-muted",children:l.recentOrders.map(e=>{var t;return(0,a.jsxs)("li",{className:"py-2 flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("span",{children:["Order ",(0,a.jsxs)(K.default,{href:"/admin/orders/".concat(e.id),className:"text-primary underline",children:["#",e.orderNumber]})," by ",(null===(t=e.user)||void 0===t?void 0:t.name)||"Unknown"]}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleString()})]},e.id)})})}),(0,a.jsxs)("div",{className:"bg-card rounded-lg p-6 shadow border mt-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold flex items-center gap-2",children:"Low Stock Products"}),(0,a.jsx)(o.z,{size:"sm",onClick:A,disabled:x,"aria-busy":x,children:x?"Suggesting...":"Suggest POs"})]}),0===p.length?(0,a.jsx)("div",{className:"text-muted-foreground",children:"No products are low in stock."}):(0,a.jsxs)("table",{className:"min-w-full border mb-2",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100",children:[(0,a.jsx)("th",{className:"p-2 text-left",children:"Product"}),(0,a.jsx)("th",{className:"p-2 text-left",children:"Stock"}),(0,a.jsx)("th",{className:"p-2 text-left",children:"Threshold"}),(0,a.jsx)("th",{className:"p-2 text-left",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:p.map(e=>(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"p-2",children:e.name}),(0,a.jsx)("td",{className:"p-2",children:e.stockQuantity}),(0,a.jsx)("td",{className:"p-2",children:e.effectiveLowStockThreshold}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)(K.default,{href:"/admin/purchase-orders/new?productId=".concat(e.id,"&quantity=").concat(Math.max(1,e.effectiveLowStockThreshold-e.stockQuantity+1)),children:(0,a.jsx)(o.z,{size:"sm",children:"Create PO"})})})]},e.id))})]})]})]}),y&&s&&en[s]&&(0,a.jsx)(er,{steps:en[s],isOpen:y,onClose:()=>N(!1),onComplete:()=>{N(!1),k(!0),localStorage.setItem("admin-tour-completed","true")},userRole:s})]})}function eh(e){var t;let{name:s,role:r,onStartTour:n,hasCompletedTour:i}=e;return(0,a.jsxs)("div",{className:"bg-green-100 border border-green-300 text-green-900 rounded-lg p-4 mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-bold text-lg mb-1",children:["Welcome, ",s,"!"]}),(0,a.jsxs)("div",{className:"text-sm",children:["You are logged in as ",(0,a.jsx)("span",{className:"font-semibold uppercase",children:r}),".",(0,a.jsx)("br",{}),(0,a.jsxs)("ul",{className:"list-disc ml-6 mt-2",children:[(0,a.jsx)("li",{children:"Use the tabs on the left to manage products, customers, orders, and import/export data."}),(0,a.jsx)("li",{children:"Check analytics and recent activity in the Overview tab."}),(0,a.jsx)("li",{children:"Need help? See the admin guide or contact support."})]})]})]}),n&&!i&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eo,{content:(null===(t=ed[r.toLowerCase()])||void 0===t?void 0:t.content)||"Get help with admin features",title:"Quick Help",variant:"info"}),(0,a.jsxs)(o.z,{size:"sm",onClick:n,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[(0,a.jsx)(q.Z,{className:"h-4 w-4 mr-1"}),"Start Tour"]})]})]})}},35974:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var a=s(57437);s(2265);var r=s(77712),n=s(94508);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},62869:function(e,t,s){"use strict";s.d(t,{d:function(){return o},z:function(){return d}});var a=s(57437),r=s(2265),n=s(37053),i=s(77712),l=s(94508);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:r,size:i,className:s})),ref:t,...c})});d.displayName="Button"},66070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return o}});var a=s(57437),r=s(2265),n=s(94508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});i.displayName="Card";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});l.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},93022:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var a=s(57437),r=s(94508);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...s})}},81103:function(e,t,s){"use strict";s.d(t,{_v:function(){return c},aJ:function(){return d},pn:function(){return l},u:function(){return o}});var a=s(57437),r=s(2265),n=s(61312),i=s(94508);let l=n.zt,o=n.fC,d=n.xz,c=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...l}=e;return(0,a.jsx)(n.VY,{ref:t,sideOffset:r,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})});c.displayName=n.VY.displayName},35153:function(e,t,s){"use strict";s.d(t,{Am:function(){return u},pm:function(){return m}});var a=s(2265);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(d);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},32507:function(e,t,s){"use strict";s.d(t,{_:function(){return i}});var a,r=s(93340),n=s(40257);let i=null!==(a=globalThis.prisma)&&void 0!==a?a:new r.PrismaClient({log:["error"],datasources:{db:{url:n.env.DATABASE_URL}}});n.on("beforeExit",async()=>{await i.$disconnect()})},94508:function(e,t,s){"use strict";s.d(t,{Bp:function(){return i},cn:function(){return n}});var a=s(61994),r=s(53335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}function i(e,t){if(e===t)return 0;if(!e.length)return t.length;if(!t.length)return e.length;let s=Array.from({length:e.length+1},()=>Array(t.length+1).fill(0));for(let t=0;t<=e.length;t++)s[t][0]=t;for(let e=0;e<=t.length;e++)s[0][e]=e;for(let a=1;a<=e.length;a++)for(let r=1;r<=t.length;r++){let n=e[a-1]===t[r-1]?0:1;s[a][r]=Math.min(s[a-1][r]+1,s[a][r-1]+1,s[a-1][r-1]+n)}return s[e.length][t.length]}s(32507)}},function(e){e.O(0,[2981,8183,9049,605,2599,2972,1608,4267,2971,2117,1744],function(){return e(e.s=15445)}),_N_E=e.O()}]);